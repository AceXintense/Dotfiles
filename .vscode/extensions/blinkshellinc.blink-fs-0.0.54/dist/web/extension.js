(()=>{"use strict";var e={372:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageType=void 0;const s=r(496);var i;!function(e){e[e.cancel=1]="cancel",e[e.binary=2]="binary",e[e.json=3]="json",e[e.jsonWithBinary=4]="jsonWithBinary",e[e.error=5]="error"}(i=t.MessageType||(t.MessageType={}));class o{constructor(e){this.id=e,this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}}t.default=class{constructor(e){this._stringEncoder=new TextEncoder,this._stringDecoder=new TextDecoder,this._msgID=1,this._pendingRequests={},this._unsentMessages=[],this._ws=null,this._isClosed=!0,this.onRequest=()=>{console.error("handler is not installed")},this._startWebSocket(e)}onopen(){return n(this,void 0,void 0,(function*(){console.error("onopen handler not found")}))}_startWebSocket(e){var t=this;let r=new WebSocket(e);r.binaryType="arraybuffer",this._ws=r,r&&(r.onopen=function(){return n(this,void 0,void 0,(function*(){t._isClosed=!1,yield t.onopen(),t._unsentMessages.forEach((e=>r.send(e))),t._unsentMessages=[]}))},r.onerror=function(e){console.error(e)},r.onclose=function(r){t._isClosed=!0,setTimeout((()=>{t._startWebSocket(e)}),5e3)},r.onmessage=function(e){if(null===e.data);else{let r=new Uint8Array(e.data);t._onBinaryMessage(r)}})}_onBinaryMessage(e){let t=this.parseMessage(e);if(t)switch(t.type){case i.cancel:this._onCancel(t.cancelID);break;case i.error:this._onError(t.refID,t.body);break;case i.json:0==t.refID?this._onRequest(t.id,t.body,null):this._onResponse(t.refID,t.body,null);break;case i.jsonWithBinary:0==t.refID?this._onRequest(t.id,t.body,t.data):this._onResponse(t.refID,t.body,t.data);break;case i.binary:0==t.refID?this._onRequest(t.id,{},t.data):this._onResponse(t.refID,{},t.data)}else console.error("unknown message",e)}_onRequest(e,t,r){var n=this;this.onRequest(t,r).then((function(t){n.reply(e,t.body,t.data)})).catch((function(t){n.replyError(e,t)}))}request(e,t){let r,n=this._msgID++,s=new o(n);return r=null===t?this._writeJson(s.id,0,e):this._writeJsonWithBinary(s.id,0,e,t),this._pendingRequests[n]=s,this._send(r),s.promise}notify(e,t){let r;r=null===t?this._writeJson(0,0,e):this._writeJsonWithBinary(0,0,e,t),this._send(r)}reply(e,t,r){let n;n=null===r?this._writeJson(0,e,t):this._writeJsonWithBinary(0,e,t,r),this._send(n)}replyError(e,t){let r;r=this._writeJson(0,e,t),this._send(r)}_send(e){var t;this._isClosed?(console.log("STACKING REQUEST"),this._unsentMessages.push(e)):null===(t=this._ws)||void 0===t||t.send(e)}_onResponse(e,t,r){let n=this._pendingRequests[e];n&&(delete this._pendingRequests[e],n.resolve&&n.resolve({body:t,data:r}))}_onError(e,t){let r,n=this._pendingRequests[e];if(n&&(delete this._pendingRequests[e],n.reject)){switch(t.errorCode){case"FileExists":r=s.FileSystemError.FileExists(t.uri);break;case"FileNotFound":r=s.FileSystemError.FileNotFound(t.uri);break;case"NoPermissions":r=s.FileSystemError.NoPermissions(t.uri);break;default:r=Error()}n.reject(r)}}_onCancel(e){let t=this._pendingRequests[e];t&&(delete this._pendingRequests[e],t.resolve&&t.resolve(null))}parseMessage(e){if(e.length<5)return null;switch(e[0]){case i.cancel:return this._parseCancel(e);case i.json:return this._parseJson(e);case i.jsonWithBinary:return this._parseJsonWithBinary(e);case i.binary:return this._parseBinary(e);case i.error:return this._parseError(e);default:return null}}_parseError(e){if(e.length<9)return null;let t=this._getU32(e.subarray(1)),r=this._getU32(e.subarray(5));var n={};if(e.length>9){let t=e.subarray(9),r=this._stringDecoder.decode(t);n=JSON.parse(r)}return{type:i.error,id:t,refID:r,body:n}}_parseJson(e){if(e.length<9)return null;let t=this._getU32(e.subarray(1)),r=this._getU32(e.subarray(5));var n={};if(e.length>9){let t=e.subarray(9),r=this._stringDecoder.decode(t);n=JSON.parse(r)}return{type:i.json,id:t,refID:r,body:n}}_writeJson(e,t,r){let n=JSON.stringify(r),s=this._stringEncoder.encode(n),o=s.length;var a=new Uint8Array(9+o);return a[0]=i.json,this._putU32(a,e,1),this._putU32(a,t,5),a.set(s,9),a}_parseJsonWithBinary(e){if(e.length<13)return null;let t=this._getU32(e.subarray(1)),r=this._getU32(e.subarray(5)),n=this._getU32(e.subarray(9));var s={};if(n>0){let t=e.subarray(13,13+n),r=this._stringDecoder.decode(t);s=JSON.parse(r)}let o=e.subarray(13+n);return{type:i.jsonWithBinary,id:t,refID:r,body:s,data:o}}_writeJsonWithBinary(e,t,r,n){let s=JSON.stringify(r),o=this._stringEncoder.encode(s),a=o.length;var u=new Uint8Array(13+a+n.length);return u[0]=i.jsonWithBinary,this._putU32(u,e,1),this._putU32(u,t,5),this._putU32(u,a,9),u.set(o,13),u.set(n,13+a),u}_parseCancel(e){if(e.length<13)return null;let t=this._getU32(e.subarray(1)),r=this._getU32(e.subarray(5)),n=this._getU32(e.subarray(9));return{type:i.cancel,id:t,refID:r,cancelID:n}}_writeCancel(e,t,r){var n=new Uint8Array(13);return n[0]=i.cancel,this._putU32(n,e,1),this._putU32(n,t,5),this._putU32(n,r,9),n}_parseBinary(e){if(e.length<9)return null;let t=this._getU32(e.subarray(1)),r=this._getU32(e.subarray(5)),n=e.subarray(9);return{type:i.binary,id:t,refID:r,data:n}}_writeBinary(e,t,r){let n=9+r.length,s=new Uint8Array(n);return s[0]=i.binary,this._putU32(s,e,1),this._putU32(s,t,5),s.set(r,9),s}_putU32(e,t,r){let n=255&t,s=t>>8&255,i=t>>16&255,o=t>>24&255;e[r+0]=o,e[r+1]=i,e[r+2]=s,e[r+3]=n}_getU32(e){return e[0]<<24|e[1]<<16|e[2]<<8|e[3]}}},236:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deactivate=t.activate=void 0;const s=r(496),i=r(372);class o{constructor(e){this.type=s.FileType.Directory,this.ctime=Date.now(),this.mtime=Date.now(),this.size=0,this.name=e,this.entries=new Map}}class a{constructor(e){this.root=new o(""),this._emitter=new s.EventEmitter,this.onDidChangeFile=this._emitter.event,this._channel=e}getMount(e,t){return n(this,void 0,void 0,(function*(){return(yield this._channel.request({op:"getRoot",token:e,version:t},null)).body}))}stat(e){return n(this,void 0,void 0,(function*(){return(yield this._channel.request({op:"stat",uri:e.toString()},null)).body}))}readDirectory(e){return n(this,void 0,void 0,(function*(){return(yield this._channel.request({op:"readDirectory",uri:e.toString()},null)).body}))}readFile(e){return n(this,void 0,void 0,(function*(){let t=yield this._channel.request({op:"readFile",uri:e.toString()},null);if(null==t.data)throw s.FileSystemError.FileNotFound();return t.data}))}writeFile(e,t,r){return n(this,void 0,void 0,(function*(){yield this._channel.request({op:"writeFile",uri:e.toString(),options:r},t)}))}rename(e,t,r){return n(this,void 0,void 0,(function*(){yield this._channel.request({op:"rename",oldUri:e.toString(),newUri:t.toString(),options:r},null)}))}delete(e,t){return n(this,void 0,void 0,(function*(){yield this._channel.request({op:"delete",uri:e.toString(),options:t},null)}))}createDirectory(e){return n(this,void 0,void 0,(function*(){yield this._channel.request({op:"createDirectory",uri:e.toString()},null)}))}watch(e){return new s.Disposable((()=>{}))}}var u=null;t.activate=function(e){return n(this,void 0,void 0,(function*(){var t=r.g.navigator.userAgent.match(/\bBlinkSH\/(\d+)\s*\(\s*(wss?)\s*;\s*(\d+)\s*;\s*(\d+)\)/);if(!t)return;let o=parseInt(t[1],10),l=t[2]||"ws",h=parseInt(t[3]||"10015",10),c=parseInt(t[4]||"0",10),d=`${l}://localhost:${h}`,y=new i.default(d);y.onopen=function(){return n(this,void 0,void 0,(function*(){let e=yield u.getMount(c,o),t=s.Uri.parse(e.root);var r;try{r=yield u.stat(t)}catch(e){throw e}let n=s.workspace.workspaceFolders,i=n?n.length:0;r.type===s.FileType.File?yield s.commands.executeCommand("vscode.open",t):e.newFile?yield s.commands.executeCommand("vscode.open",s.Uri.parse(e.newFile)):0===i&&s.workspace.updateWorkspaceFolders(0,i,{uri:t})}))};const _=new a(y);u=_,e.subscriptions.push(s.workspace.registerFileSystemProvider("blinkfs",_,{isCaseSensitive:!0})),e.subscriptions.push(s.workspace.registerFileSystemProvider("blinksftp",_,{isCaseSensitive:!0}))}))},t.deactivate=function(){}},496:e=>{e.exports=require("vscode")}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var n=r(236),s=exports;for(var i in n)s[i]=n[i];n.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();